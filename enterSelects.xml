<?xml version="1.0"?>
<bindings xmlns="http://www.mozilla.org/xbl">
  <binding id="urlbar" extends="chrome://browser/content/urlbarBindings.xml#urlbar">
    <handlers>
      <handler event="keypress" phase="capturing">
      <![CDATA[
        let (e = event, _ = this.popup)
          // Make sure there's no unwanted special modifiers on the key press
          !(this.disableKeyNavigation || e.shiftKey || e.ctrlKey || e.metaKey) &&
          // We're only looking for the user hitting enter
          e.keyCode == KeyEvent.DOM_VK_RETURN &&
          // Nothing is selected in the open popup with results?
          _.selectedIndex == -1 && _.popupOpen && _._matchCount > 0 &&
          // Pretend the user pressed down just before pressing return
          this.mController.handleKeyNavigation(KeyEvent.DOM_VK_DOWN);
      ]]>
      </handler>
    </handlers>
  </binding>
</bindings>
